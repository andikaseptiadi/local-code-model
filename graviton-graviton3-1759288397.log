+ AWS_PROFILE=aws
+ AWS_REGION=us-west-2
+ AMI_ID=ami-0c5777a14602ab4b9
+ KEY_NAME=aws-benchmark-test
+ SECURITY_GROUP=sg-5059b179
+ KEY_FILE=/Users/scttfrdmn/.ssh/aws-benchmark-test.pem
+ case 'graviton3' in
+ INSTANCE_TYPE=c7g.xlarge
+ NAME=graviton3-test
+ echo '=== Creating tarball ==='
=== Creating tarball ===
+ cd /Users/scttfrdmn/src/local-code-model
+ tar czf /tmp/code-79945.tar.gz --exclude=.git '--exclude=*.o' .
+ echo '=== Launching instance ==='
=== Launching instance ===
++ aws ec2 run-instances --profile aws --region us-west-2 --image-id ami-0c5777a14602ab4b9 --instance-type c7g.xlarge --key-name aws-benchmark-test --security-group-ids sg-5059b179 --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=graviton3-test}]' --query 'Instances[0].InstanceId' --output text
+ INSTANCE_ID=i-0b979e653f5841ffb
+ echo 'Instance ID: i-0b979e653f5841ffb'
Instance ID: i-0b979e653f5841ffb
+ aws ec2 wait instance-running --profile aws --region us-west-2 --instance-ids i-0b979e653f5841ffb
++ aws ec2 describe-instances --profile aws --region us-west-2 --instance-ids i-0b979e653f5841ffb --query 'Reservations[0].Instances[0].PublicIpAddress' --output text
+ PUBLIC_IP=54.202.151.169
+ echo 'Public IP: 54.202.151.169'
Public IP: 54.202.151.169
+ echo 'i-0b979e653f5841ffb|graviton3-test|54.202.151.169'
+ echo '=== Waiting for SSH ==='
=== Waiting for SSH ===
+ sleep 30
+ echo '=== Uploading code ==='
=== Uploading code ===
+ scp -i /Users/scttfrdmn/.ssh/aws-benchmark-test.pem -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null /tmp/code-79945.tar.gz ec2-user@54.202.151.169:/tmp/code.tar.gz
Warning: Permanently added '54.202.151.169' (ED25519) to the list of known hosts.
+ echo '=== Running tests ==='
=== Running tests ===
+ ssh -i /Users/scttfrdmn/.ssh/aws-benchmark-test.pem -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ec2-user@54.202.151.169 'bash -s'
Warning: Permanently added '54.202.151.169' (ED25519) to the list of known hosts.
+ cd /tmp
+ mkdir -p test
+ cd test
+ tar xzf /tmp/code.tar.gz
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./go_model_epoch_3.pt: Wrote only 8192 of 10240 bytes
tar: ./._.gitignore: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./.gitignore: Cannot write: No space left on device
tar: ./._autograd.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./autograd.go: Cannot write: No space left on device
tar: ./._sample_go_code: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./._tokenizer_test.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer_test.go: Cannot write: No space left on device
tar: ./._ANE_IMPLEMENTATION.md: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./ANE_IMPLEMENTATION.md: Cannot write: No space left on device
tar: ./._ane_mpsgraph.m: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./ane_mpsgraph.m: Cannot write: No space left on device
tar: ./._train_tokenizer.py: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./train_tokenizer.py: Cannot write: No space left on device
tar: ./._accelerate.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./accelerate.go: Cannot write: No space left on device
tar: ./._go_model_epoch_2.pt: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./go_model_epoch_2.pt: Cannot write: No space left on device
tar: ./._matmul_sve_linux.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_sve_linux.go: Cannot write: No space left on device
tar: ./._scripts: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./._tokenizer.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer.go: Cannot write: No space left on device
tar: ./._cpu_features_linux.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./cpu_features_linux.go: Cannot write: No space left on device
tar: ./._tensor.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tensor.go: Cannot write: No space left on device
tar: ./._matmul_optimized_test.go: Cannot write: No space left on device
=== Installing deps ===
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_optimized_test.go: Cannot write: No space left on device
tar: ./._compute.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./compute.go: Cannot write: No space left on device
tar: ./._SIMD_README.md: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./SIMD_README.md: Cannot write: No space left on device
tar: ./._optimization_demo.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./optimization_demo.go: Cannot write: No space left on device
tar: ./._train_go_model.py: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./train_go_model.py: Cannot write: No space left on device
tar: ./._transformer_backward.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./transformer_backward.go: Cannot write: No space left on device
tar: ./._benchmark_comprehensive_test.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./benchmark_comprehensive_test.go: Cannot write: No space left on device
tar: ./._matmul_simd_stub.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_simd_stub.go: Cannot write: No space left on device
tar: ./._launch_graviton_bg.sh: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./launch_graviton_bg.sh: Cannot write: No space left on device
tar: ./._GRAVITON_SUMMARY.md: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./GRAVITON_SUMMARY.md: Cannot write: No space left on device
tar: ./._matmul_simd.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_simd.go: Cannot write: No space left on device
tar: ./._test_on_graviton.sh: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./test_on_graviton.sh: Cannot write: No space left on device
tar: ./._matmul_neon_arm64.s: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_neon_arm64.s: Cannot write: No space left on device
tar: ./._graviton_instances.txt: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./graviton_instances.txt: Cannot write: No space left on device
tar: ./._main.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./main.go: Cannot write: No space left on device
tar: ./._metal.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./metal.go: Cannot write: No space left on device
tar: ./._accelerate_test.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./accelerate_test.go: Cannot write: No space left on device
tar: ./._matmul_sve_stub.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./matmul_sve_stub.go: Cannot write: No space left on device
tar: ./._graviton_test.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./graviton_test.go: Cannot write: No space left on device
tar: ./scripts/._run_aws_benchmarks.sh: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./scripts/run_aws_benchmarks.sh: Cannot write: No space left on device
tar: ./sample_go_code/._main.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./sample_go_code/main.go: Cannot write: No space left on device
tar: ./tokenizer_data/._worker_pool.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer_data/worker_pool.go: Cannot write: No space left on device
tar: ./tokenizer_data/._instructions.txt: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer_data/instructions.txt: Cannot write: No space left on device
tar: ./tokenizer_data/._aws_s3.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer_data/aws_s3.go: Cannot write: No space left on device
tar: ./tokenizer_data/._cli_app.go: Cannot write: No space left on device
tar: Ignoring unknown extended header keyword 'LIBARCHIVE.xattr.com.apple.provenance'
tar: ./tokenizer_data/cli_app.go: Cannot write: No space left on device
tar: Exiting with failure status due to previous errors
+ echo '=== Installing deps ==='
+ sudo dnf install -y golang gcc openblas-devel
+ tail -10
Install  46 Packages

Total download size: 141 M
Installed size: 649 M
Downloading Packages:

The downloaded packages were saved in cache until the next successful transaction.
You can remove cached packages by executing 'dnf clean packages'.
Error: Error downloading packages:
  No URLs in mirrorlist
=== CPU Info ===
processor	: 0
Features	: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 sm3 sm4 asimddp sha512 sve asimdfhm dit uscat ilrcpc flagm paca pacg dcpodp svei8mm svebf16 i8mm bf16 dgh rng
CPU implementer	: 0x41
CPU part	: 0xd40
processor	: 1
Features	: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 sm3 sm4 asimddp sha512 sve asimdfhm dit uscat ilrcpc flagm paca pacg dcpodp svei8mm svebf16 i8mm bf16 dgh rng
CPU implementer	: 0x41
CPU part	: 0xd40
processor	: 2
Features	: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 sm3 sm4 asimddp sha512 sve asimdfhm dit uscat ilrcpc flagm paca pacg dcpodp svei8mm svebf16 i8mm bf16 dgh rng
CPU implementer	: 0x41
CPU part	: 0xd40
processor	: 3
Features	: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 sm3 sm4 asimddp sha512 sve asimdfhm dit uscat ilrcpc flagm paca pacg dcpodp svei8mm svebf16 i8mm bf16 dgh rng
CPU implementer	: 0x41
CPU part	: 0xd40
=== Building ===
=== CPU Detection ===
bash: line 17: go: command not found
bash: line 18: go: command not found
=== Benchmarks ===
bash: line 21: go: command not found
=== COMPLETE ===
+ echo '=== CPU Info ==='
+ cat /proc/cpuinfo
+ grep -E '(processor|implementer|part|Features)'
+ head -20
+ echo '=== Building ==='
+ go build -tags linux,arm64,cgo .
bash: line 14: go: command not found
+ echo '=== CPU Detection ==='
+ go test -v -run TestCPUFeatureDetection
+ go test -v -run TestGravitonDetection
+ echo '=== Benchmarks ==='
+ go test -bench BenchmarkGravitonComparison -benchtime=3s '-run=^$'
+ echo '=== COMPLETE ==='
+ echo '=== Results saved to graviton-graviton3-1759288397.log ==='
=== Results saved to graviton-graviton3-1759288397.log ===
+ echo 'To terminate: aws ec2 terminate-instances --instance-ids i-0b979e653f5841ffb --profile aws --region us-west-2'
To terminate: aws ec2 terminate-instances --instance-ids i-0b979e653f5841ffb --profile aws --region us-west-2
